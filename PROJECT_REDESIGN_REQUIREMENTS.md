# 狗抓 (Dog-Catch) 浏览器插件开发需求文档

## 📋 项目概述

本文档描述了基于 cat-catch 核心技术开发全新狗抓 (Dog-Catch) 浏览器扩展的需求，专注于两大核心功能：自动检测和媒体预览，并实现简约美观的现代化用户界面。

## 🎯 开发目标

- 移植 cat-catch 的资源检测核心技术
- 设计简约美观的现代化用户界面
- 专注两大核心功能：自动检测、媒体预览
- 集成高级媒体播放器，支持本地字幕加载
- 添加流畅的动画效果和交互体验
- 保持多平台兼容性

## 🔧 详细需求规格

### 1. 现代化用户界面设计

#### 1.1 悬浮球组件设计

**设计理念**: 极简、优雅、直观

**视觉设计**:

- 🎨 **形状**: 圆形悬浮球，直径 56px
- 🎨 **颜色**: 渐变色彩 `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
- 🎨 **效果**: 毛玻璃效果 + 微妙光晕
- 🎨 **阴影**: 动态阴影 `0 8px 32px rgba(102, 126, 234, 0.3)`
- 🎨 **图标**: 简约狗爪图标，白色，24x24px

**动画效果**:

- ✨ **悬停**: 平滑放大 1.05 倍 + 阴影扩散
- ✨ **点击**: 脉冲动画 + 涟漪效果
- ✨ **拖拽**: 实时阴影跟随 + 磁性吸附边缘
- ✨ **呼吸**: 检测到新资源时的呼吸灯效果

#### 1.2 侧边栏界面设计

**布局结构**:

- 📱 **宽度**: 360px (紧凑设计)
- 📱 **高度**: 100vh
- 📱 **位置**: 右侧滑入，支持手势操作
- 📱 **响应式**: 移动端全屏覆盖

**现代化视觉**:

- 🎨 **背景**: 渐变毛玻璃 `rgba(255,255,255,0.9)`
- 🎨 **模糊**: `backdrop-filter: blur(24px) saturate(180%)`
- 🎨 **边框**: 无边框设计，纯净简约
- 🎨 **阴影**: 深度阴影 `-4px 0 24px rgba(0,0,0,0.1)`
- 🎨 **圆角**: 左侧 16px 圆角

**动画效果**:

- ✨ **进入**: 从右侧滑入 + 透明度渐变
- ✨ **退出**: 向右滑出 + 透明度渐变
- ✨ **内容**: 列表项依次淡入，错开 50ms

### 2. 核心技术移植与功能实现

#### 2.1 核心技术移植（简化版）

- ✅ **资源嗅探引擎**: 移植 background.js 的资源检测逻辑
- ✅ **M3U8/MPD 解析器**: 移植流媒体格式解析功能
- ✅ **缓存捕捉器**: 移植 catch.js 的浏览器缓存资源提取
- ✅ **深度搜索器**: 移植 search.js 脚本注入式资源发现
- ✅ **网络监听**: 移植 webRequest API 监听和过滤逻辑
- ✅ **存储管理**: 移植数据缓存和本地存储机制

#### 2.2 两大核心功能模块

##### 核心功能 1: 自动检测网页媒体资源

**技术基础**: 基于 cat-catch 的 findMedia 函数和资源嗅探引擎

**功能特性**:

- 🔍 实时监听网络请求，自动检测媒体资源
- 🎯 智能识别视频、音频、图片等多种格式
- 📺 支持 M3U8、MPD、MP4、WebM 等流媒体格式
- 🔄 资源去重和智能过滤
- 📊 显示资源大小、时长、来源 URL 等详细信息
- 🏷️ 资源类型图标标识和分类显示

**界面设计**:

- 📋 简洁的资源列表，卡片式布局
- 🎨 每种资源类型使用不同的颜色标识
- ⚡ 实时更新，新检测到的资源有淡入动画
- 🔍 搜索过滤功能，支持按类型和名称筛选

**动画效果**:

- ✨ **新资源**: 从上方滑入 + 淡入效果
- ✨ **资源卡片**: 悬停时轻微上浮 + 阴影加深
- ✨ **类型切换**: 平滑的过滤动画
- ✨ **加载状态**: 骨架屏 + 脉冲动画

##### 核心功能 2: 媒体预览（含本地字幕加载）

**技术基础**: 集成 Video.js 播放器 + cat-catch 的预览功能

**播放器功能**:

- 🎬 **内嵌播放器**: 在侧边栏内的紧凑播放器 (320x180px)
- 🖥️ **全屏预览**: 新标签页的完整播放器体验
- 📱 **响应式设计**: 适配不同屏幕尺寸
- ⚡ **快速加载**: 优化的播放器初始化

**本地字幕功能**（重点特性）:

- 📄 **支持格式**: SRT、VTT、ASS 格式完整支持
- 📁 **加载方式**: 拖拽加载、文件选择、自动检测
- 🎨 **样式自定义**: 字体、大小、颜色、描边、背景
- 🌐 **多语言支持**: 多轨字幕切换和管理
- ⚙️ **同步调整**: 字幕时间偏移微调（±5 秒精度）
- 📝 **位置调节**: 字幕显示位置和边距设置
- 💾 **设置保存**: 用户字幕偏好设置记忆

**高级播放功能**:

- 🚀 **倍速播放**: 0.25x, 0.5x, 0.75x, 1x, 1.25x, 1.5x, 2x, 4x
- 🎬 **全屏模式**: F 键或双击进入全屏
- 🖼️ **画中画模式**: P 键开启画中画
- ⌨️ **键盘快捷键**: 完整的键盘操作支持
- 🔄 **循环播放**: 单曲循环和列表循环

**动画效果**:

- ✨ **播放器加载**: 淡入动画 + 进度条
- ✨ **控制栏**: 自动隐藏/显示，平滑过渡
- ✨ **字幕**: 字幕切换时的淡入淡出效果
- ✨ **全屏**: 平滑的全屏进入/退出动画

#### 2.3 简化设计原则

- 专注两大核心功能：自动检测 + 媒体预览
- 移除复杂的下载管理功能，保持界面简洁
- 保留 cat-catch 的资源检测核心技术
- 强化媒体预览和字幕功能的用户体验
- 通过动画效果提升交互的流畅性和愉悦感

### 3. 动画效果与交互设计

#### 3.1 全局动画系统

**动画设计原则**:

- 🎯 **有意义**: 每个动画都有明确的功能目的
- ⚡ **快速**: 动画时长控制在 200-300ms
- 🌊 **流畅**: 使用 CSS3 硬件加速和缓动函数
- 🎨 **一致**: 统一的动画语言和时序

**缓动函数**:

- **进入**: `cubic-bezier(0.25, 0.46, 0.45, 0.94)` (ease-out-quad)
- **退出**: `cubic-bezier(0.55, 0.06, 0.68, 0.19)` (ease-in-quad)
- **弹性**: `cubic-bezier(0.68, -0.55, 0.265, 1.55)` (back-out)

#### 3.2 悬浮球动画效果

**状态动画**:

- ✨ **空闲状态**: 轻微的呼吸动画 (scale: 1.0 ↔ 1.02)
- ✨ **悬停状态**: 放大 + 阴影扩散 (scale: 1.05, shadow: 0 12px 40px)
- ✨ **点击状态**: 脉冲 + 涟漪效果
- ✨ **拖拽状态**: 实时阴影跟随 + 磁性吸附

**检测状态动画**:

- 🔍 **检测中**: 旋转的扫描线动画
- 📊 **发现资源**: 从中心向外的波纹扩散
- 💫 **新资源**: 短暂的光晕闪烁效果

#### 3.3 侧边栏动画效果

**进入/退出动画**:

- 🚀 **滑入**: `transform: translateX(100%) → translateX(0)`
- 🌊 **淡入**: `opacity: 0 → 1`
- 📱 **背景模糊**: `backdrop-filter: blur(0px) → blur(24px)`

**内容动画**:

- 📋 **列表项**: 依次从右侧滑入，错开 50ms
- 🎨 **卡片悬停**: 轻微上浮 (translateY: 0 → -2px)
- 🔄 **状态切换**: 平滑的颜色和透明度过渡

#### 3.4 媒体预览动画

**播放器动画**:

- 🎬 **加载**: 骨架屏 → 淡入播放器
- 🎮 **控制栏**: 自动隐藏/显示 (opacity + translateY)
- 📺 **全屏**: 平滑的尺寸和位置过渡

**字幕动画**:

- 📝 **字幕切换**: 淡出 → 淡入 (crossfade)
- 🎨 **样式调整**: 实时预览效果
- 📍 **位置调节**: 平滑的位置过渡

### 4. 资源预览功能优化

#### 4.1 预览模式

- **内嵌预览**: 在侧边界面内直接预览
  - 小窗口播放器
  - 基本控制按钮
  - 音量调节
- **新标签页预览**: 独立页面全功能预览
  - 全屏播放支持
  - 完整播放器控制
  - 高级功能集成

#### 4.2 播放器功能规格

##### 4.2.1 基础播放控制

- ▶️ 播放/暂停
- ⏮️ 快退 (10 秒/30 秒可配置)
- ⏭️ 快进 (10 秒/30 秒可配置)
- 🔊 音量控制 (0-100%)
- 🔇 静音切换
- 📊 进度条拖拽

##### 4.2.2 高级播放功能

- 🚀 倍速播放 (0.25x - 4.0x)
- 🎬 全屏模式
- 🖼️ 画中画模式
- 📱 响应式控制界面
- ⌨️ 键盘快捷键支持

##### 4.2.3 本地字幕加载功能（重点特性）

**支持的字幕格式**:

- 📄 **SRT 格式**: 最常用的字幕格式，完整支持
- 📄 **VTT 格式**: Web 标准字幕格式，原生支持
- 📄 **ASS 格式**: 高级字幕样式格式，样式保持

**字幕加载方式**:

- 🖱️ **拖拽加载**: 直接拖拽字幕文件到播放器
- 📁 **文件选择**: 点击按钮选择本地字幕文件
- 🔍 **自动检测**: 自动检测同名字幕文件
- � **网络字幕**: 支持在线字幕 URL 加载

**字幕功能特性**:

- 🎨 **样式自定义**: 字体、大小、颜色、描边、背景
- 🌐 **多语言支持**: 多轨字幕切换和管理
- ⚙️ **同步调整**: 字幕时间偏移微调（±5 秒精度）
- 📝 **位置调节**: 字幕显示位置和边距设置
- 💾 **设置保存**: 用户字幕偏好设置记忆

#### 4.3 Video.js 播放器技术方案

**选择理由**: Video.js 是业界领先的开源 HTML5 视频播放器

- ✅ **丰富插件生态**: 字幕、快捷键、画中画等插件完善
- ✅ **高度可定制**: 支持自定义皮肤和控制组件
- ✅ **移动端友好**: 响应式设计，触摸操作优化
- ✅ **格式支持广泛**: 支持 HLS、DASH、MP4 等主流格式
- ✅ **社区活跃**: 持续更新维护，文档完善
- ✅ **轻量高效**: 核心库小于 100KB，性能优秀

### 5. 开发计划与里程碑

#### 5.1 简化的开发阶段

**阶段 1: 核心技术移植 (2 周)**

- 移植 cat-catch 的资源检测引擎
- 实现基础的网络监听和数据存储
- 创建基本的项目结构

**阶段 2: 现代化界面开发 (3 周)**

- 设计和实现悬浮球组件
- 开发侧边栏界面和动画效果
- 实现响应式布局和交互

**阶段 3: 媒体预览功能 (3 周)**

- 集成 Video.js 播放器
- 实现本地字幕加载功能
- 完善播放器控制和动画

**阶段 4: 测试与优化 (2 周)**

- 跨浏览器兼容性测试
- 性能优化和 Bug 修复
- 用户体验测试和改进

#### 5.2 成功指标

**技术指标**:

- 界面响应时间 < 100ms
- 资源检测准确率 > 95%
- 播放器加载时间 < 2s
- 内存占用 < 30MB

**用户体验指标**:

- 动画流畅度 60fps
- 字幕加载成功率 > 95%
- 用户满意度 > 4.5/5.0

### 6. 总结

Dog-Catch 将是一个专注于**自动检测**和**媒体预览**的简约浏览器插件，具有以下特点：

🎯 **核心功能**:

- 基于 cat-catch 技术的智能资源检测
- 集成 Video.js 的专业媒体预览
- 完整的本地字幕加载支持

🎨 **现代化设计**:

- 极简优雅的悬浮球设计
- 流畅的动画效果和交互
- 响应式的侧边栏界面

⚡ **技术优势**:

- 移植成熟稳定的核心技术
- 现代化的 Manifest V3 架构
- 跨平台浏览器兼容性

通过专注于两大核心功能和现代化的用户体验，Dog-Catch 将为用户提供简洁高效的媒体资源管理工具。

---

**文档版本**: v3.0 (简化版)
**创建日期**: 2025-08-06
**最后更新**: 2025-08-07
**项目**: Dog-Catch 浏览器插件开发
**技术基础**: 基于 Cat-Catch 核心技术，专注自动检测和媒体预览

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åª’ä½“èµ„æºæ¼”ç¤ºé¡µé¢ - Dog-Catch æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2196F3;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        .section h2 {
            color: #666;
            margin-top: 0;
        }
        .media-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #2196F3;
        }
        .media-item h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .media-url {
            word-break: break-all;
            font-family: monospace;
            font-size: 12px;
            color: #666;
            background: #fff;
            padding: 5px;
            border-radius: 3px;
        }
        .btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover {
            background: #1976D2;
        }
        .status {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            text-align: center;
        }
        video, audio {
            max-width: 100%;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>åª’ä½“èµ„æºæ¼”ç¤ºé¡µé¢</h1>
        <div class="status">
            ğŸ“¡ Dog-Catch æ‰©å±•åº”è¯¥èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹åˆ°æ­¤é¡µé¢ä¸Šçš„åª’ä½“èµ„æº
        </div>
        
        <div class="section">
            <h2>ğŸ¥ è§†é¢‘èµ„æº</h2>
            <div class="media-item">
                <h3>MP4 è§†é¢‘ç¤ºä¾‹</h3>
                <div class="media-url">https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4</div>
                <button class="btn" onclick="loadVideo('mp4')">åŠ è½½è§†é¢‘</button>
                <video id="video-mp4" controls style="display:none;"></video>
            </div>
            
            <div class="media-item">
                <h3>WebM è§†é¢‘ç¤ºä¾‹</h3>
                <div class="media-url">https://sample-videos.com/zip/10/webm/SampleVideo_1280x720_1mb.webm</div>
                <button class="btn" onclick="loadVideo('webm')">åŠ è½½è§†é¢‘</button>
                <video id="video-webm" controls style="display:none;"></video>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸµ éŸ³é¢‘èµ„æº</h2>
            <div class="media-item">
                <h3>MP3 éŸ³é¢‘ç¤ºä¾‹</h3>
                <div class="media-url">https://www.soundjay.com/misc/sounds/bell-ringing-05.wav</div>
                <button class="btn" onclick="loadAudio('mp3')">åŠ è½½éŸ³é¢‘</button>
                <audio id="audio-mp3" controls style="display:none;"></audio>
            </div>
            
            <div class="media-item">
                <h3>WAV éŸ³é¢‘ç¤ºä¾‹</h3>
                <div class="media-url">https://file-examples.com/storage/fe68c8a7c4c6f3c7b8b7b8b/2017/11/file_example_WAV_1MG.wav</div>
                <button class="btn" onclick="loadAudio('wav')">åŠ è½½éŸ³é¢‘</button>
                <audio id="audio-wav" controls style="display:none;"></audio>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ“º æµåª’ä½“èµ„æº</h2>
            <div class="media-item">
                <h3>HLS (M3U8) æµåª’ä½“</h3>
                <div class="media-url">https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8</div>
                <button class="btn" onclick="fetchStream('m3u8')">è·å– M3U8</button>
                <div id="stream-m3u8-result"></div>
            </div>
            
            <div class="media-item">
                <h3>DASH (MPD) æµåª’ä½“</h3>
                <div class="media-url">https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd</div>
                <button class="btn" onclick="fetchStream('mpd')">è·å– MPD</button>
                <div id="stream-mpd-result"></div>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ”„ åŠ¨æ€åŠ è½½æµ‹è¯•</h2>
            <button class="btn" onclick="dynamicLoadTest()">åŠ¨æ€åŠ è½½åª’ä½“èµ„æº</button>
            <button class="btn" onclick="ajaxTest()">AJAX è¯·æ±‚æµ‹è¯•</button>
            <button class="btn" onclick="fetchTest()">Fetch API æµ‹è¯•</button>
            <div id="dynamic-result"></div>
        </div>
        
        <div class="section">
            <h2>ğŸ“Š æ£€æµ‹çŠ¶æ€</h2>
            <button class="btn" onclick="checkDetectionStatus()">æ£€æŸ¥æ£€æµ‹çŠ¶æ€</button>
            <div id="detection-status"></div>
        </div>
    </div>
    
    <script>
        // åŠ è½½è§†é¢‘
        function loadVideo(type) {
            const video = document.getElementById(`video-${type}`);
            const urls = {
                'mp4': 'https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4',
                'webm': 'https://sample-videos.com/zip/10/webm/SampleVideo_1280x720_1mb.webm'
            };
            
            video.src = urls[type];
            video.style.display = 'block';
            video.load();
        }
        
        // åŠ è½½éŸ³é¢‘
        function loadAudio(type) {
            const audio = document.getElementById(`audio-${type}`);
            const urls = {
                'mp3': 'https://www.soundjay.com/misc/sounds/bell-ringing-05.wav',
                'wav': 'https://file-examples.com/storage/fe68c8a7c4c6f3c7b8b7b8b/2017/11/file_example_WAV_1MG.wav'
            };
            
            audio.src = urls[type];
            audio.style.display = 'block';
            audio.load();
        }
        
        // è·å–æµåª’ä½“
        function fetchStream(type) {
            const resultDiv = document.getElementById(`stream-${type}-result`);
            const urls = {
                'm3u8': 'https://devstreaming-cdn.apple.com/videos/streaming/examples/img_bipbop_adv_example_fmp4/master.m3u8',
                'mpd': 'https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd'
            };
            
            resultDiv.innerHTML = 'æ­£åœ¨è·å–æµåª’ä½“ä¿¡æ¯...';
            
            fetch(urls[type])
                .then(response => response.text())
                .then(data => {
                    resultDiv.innerHTML = `<pre style="max-height:200px;overflow:auto;font-size:10px;">${data.substring(0, 500)}...</pre>`;
                })
                .catch(error => {
                    resultDiv.innerHTML = `è·å–å¤±è´¥: ${error.message}`;
                });
        }
        
        // åŠ¨æ€åŠ è½½æµ‹è¯•
        function dynamicLoadTest() {
            const result = document.getElementById('dynamic-result');
            result.innerHTML = 'æ­£åœ¨åŠ¨æ€åˆ›å»ºåª’ä½“å…ƒç´ ...';
            
            // åŠ¨æ€åˆ›å»ºè§†é¢‘å…ƒç´ 
            const video = document.createElement('video');
            video.src = 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4';
            video.controls = true;
            video.style.maxWidth = '100%';
            
            result.innerHTML = 'åŠ¨æ€è§†é¢‘å…ƒç´ å·²åˆ›å»º';
            result.appendChild(video);
        }
        
        // AJAX æµ‹è¯•
        function ajaxTest() {
            const result = document.getElementById('dynamic-result');
            result.innerHTML += '<br>æ­£åœ¨è¿›è¡Œ AJAX è¯·æ±‚...';
            
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://sample-videos.com/zip/10/mp4/SampleVideo_640x360_1mb.mp4', true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    result.innerHTML += `<br>AJAX è¯·æ±‚å®Œæˆ: ${xhr.status}`;
                }
            };
            xhr.send();
        }
        
        // Fetch API æµ‹è¯•
        function fetchTest() {
            const result = document.getElementById('dynamic-result');
            result.innerHTML += '<br>æ­£åœ¨è¿›è¡Œ Fetch è¯·æ±‚...';
            
            fetch('https://www.soundjay.com/misc/sounds/bell-ringing-04.wav', { method: 'HEAD' })
                .then(response => {
                    result.innerHTML += `<br>Fetch è¯·æ±‚å®Œæˆ: ${response.status}`;
                })
                .catch(error => {
                    result.innerHTML += `<br>Fetch è¯·æ±‚å¤±è´¥: ${error.message}`;
                });
        }
        
        // æ£€æŸ¥æ£€æµ‹çŠ¶æ€
        function checkDetectionStatus() {
            const result = document.getElementById('detection-status');
            result.innerHTML = 'æ­£åœ¨æ£€æŸ¥ Dog-Catch æ£€æµ‹çŠ¶æ€...';
            
            if (chrome && chrome.runtime) {
                chrome.runtime.sendMessage({ Message: "getAllData" }, function(response) {
                    if (chrome.runtime.lastError) {
                        result.innerHTML = `æ£€æµ‹çŠ¶æ€: æ‰©å±•é€šä¿¡å¤±è´¥ - ${chrome.runtime.lastError.message}`;
                    } else if (response && typeof response === 'object') {
                        let totalCount = 0;
                        for (let tabId in response) {
                            if (Array.isArray(response[tabId])) {
                                totalCount += response[tabId].length;
                            }
                        }
                        result.innerHTML = `æ£€æµ‹çŠ¶æ€: å·²æ£€æµ‹åˆ° ${totalCount} ä¸ªåª’ä½“èµ„æº`;
                        
                        if (totalCount > 0) {
                            result.innerHTML += '<br><strong>æ£€æµ‹åˆ°çš„èµ„æº:</strong>';
                            for (let tabId in response) {
                                if (Array.isArray(response[tabId]) && response[tabId].length > 0) {
                                    response[tabId].forEach(item => {
                                        result.innerHTML += `<div style="margin:5px 0;padding:5px;background:#f0f0f0;">
                                            <strong>${item.name || 'Unknown'}</strong> (${item.ext || 'unknown'})
                                            <br><small>${item.url}</small>
                                        </div>`;
                                    });
                                }
                            }
                        }
                    } else {
                        result.innerHTML = 'æ£€æµ‹çŠ¶æ€: æš‚æ— æ£€æµ‹åˆ°çš„åª’ä½“èµ„æº';
                    }
                });
            } else {
                result.innerHTML = 'æ£€æµ‹çŠ¶æ€: Chrome æ‰©å±• API ä¸å¯ç”¨';
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è§¦å‘ä¸€äº›è¯·æ±‚
        document.addEventListener('DOMContentLoaded', function() {
            console.log('åª’ä½“æ¼”ç¤ºé¡µé¢å·²åŠ è½½ï¼ŒDog-Catch åº”è¯¥å¼€å§‹æ£€æµ‹åª’ä½“èµ„æº');
            
            // å»¶è¿Ÿè§¦å‘ä¸€äº›è¯·æ±‚ï¼Œè®©ç”¨æˆ·çœ‹åˆ°æ£€æµ‹è¿‡ç¨‹
            setTimeout(() => {
                fetch('https://httpbin.org/json').then(() => {
                    console.log('JSON è¯·æ±‚å®Œæˆ');
                });
            }, 2000);
            
            setTimeout(() => {
                fetch('https://httpbin.org/image/png').then(() => {
                    console.log('å›¾ç‰‡è¯·æ±‚å®Œæˆ');
                });
            }, 4000);
        });
    </script>
</body>
</html>
